$Y = g_1^{x_1} * g_2^{x_2}$
$R(pt) = g_1^{r_1(pt)} * g_2^{r_2(pt)}$
$s_1(pt) = r_1(pt) + x_1 * hash([pt, R(pt)])$
$s_2(pt) = r_2(pt) + x_2 * hash([pt, R(pt)])$

已知 
$pt_1 = "Hi! Can you store the encrypted flag for me for a second? I will need it later."$
$s_1(pt_1) = 13205737753786145631452557588406232353600988478055542460813697878122967446578$
$s_2(pt_1) = 13958963271047914149117054426506396333295463042827503250264570272717038726261$
$R(pt_1) = 10975523781415982714076120021487634912523174941670197886572626886997379163321$
,
$pt_2 = "Here's the flag: 2ccb051234f87b7786c829e31ed2539d62f93c39da366b5d8a74890960c1fc38d33b6fbd804fb5aa555e3e2928e1e06c564956eb2f320dde516ababeb71d525b9069538a7abc76cb3c94b7955654c041"$
$s_1(pt_2) = 9179666933751539920348309886276181210967936400505991858211575258442611791125$
$s_2(pt_2) = 9320577211559440207387497803168253329006224294550698569339457019099653730952$
$R(pt_2) = 27255728356841764650107110242922607077260936240190827215432957010403469676198$

求解 $x_1 - x_2$

## Solution

1. 联立 $s_1(pt_1)$ 和 $s_1(pt_2)$ 解得 $r_1(pt_1)$ 和 $r_1(pt_2)$ 的线性关系
2. 同理，联立 $s_2(pt_1)$ 和 $s_2(pt_2)$ 解得 $r_2(pt_1)$ 和 $r_2(pt_2)$ 的线性关系、
3. 代入 $R(pt) = g_1^{r_1(pt)} * g_2^{r_2(pt)}$，得到 $R(pt_2) = g_1^{k_1(r_1(pt_1))} * g_2^{k_2(r_2(pt_1))}$
4. 联立 $R(pt_2) = g_1^{k_1(r_1(pt_1))} * g_2^{k_2(r_2(pt_1))}$ 和 $R(pt_1) = g_1^{r_1(pt_1)} * g_2^{r_2(pt_1)}$ (两式相除，可以消去 $r_1(pt_1)$ 或者 $r_2(pt_1)$)，求出 $r_1(pt_1)$ 或者 $r_2(pt_1)$
5. 代入上式，求得 $x_1$ 和 $x_2$，进而解得 $x_1 - x_2$